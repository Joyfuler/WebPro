<!DOCTYPE html>
<html lang="ko">
    <head>
    <meta charset="UTF-8">
    <title>수정하기</title>
    <script>
        
    </script>
    <link href = "https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link href = "/css/style.css" rel = "stylesheet" type = "text/css">
</head>
<body>    
    <%- include('nav.html') %>
      <div class="container-fluid py-5">
        <h1 class="display-5 fw-bold"><%=post._id %> 번 수정페이지</h1>
          <!--<form action = "/update" method = "post">-->
          <!--<input type = "hidden" name = "_id" value = "<%=post._id%>">-->
            <div class="mb-3">
              <label for="title" class="form-label">할 일</label>
              <input type="text" class="form-control" id="title" name = "title"
              value = "<%=post.title %>">
            </div>
            <div class="mb-3">
              <label for="date" class="form-label">마감일</label>
              <input type = "date" class="form-control" id="date" rows="3" name = "date"
              value = "<%=post.date %>">
            </div>
            <div class="col-auto">
              <button type="submit" class="btn btn-primary mb-3 update">할일 수정</button>
            </div>
          <!-- </form>-->
        </div>
      </div>
      <br><br>      
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>  
    <script>
        $(document).ready(function(){          
          $('button.update').click(function(){
            var id = '<%=post._id%>'; // 넘길때는 number,parseInt하지 않아도 무방. 받을 때 해주자
            var title = $('input[name="title"]').val();            
            var date = $('input[name="date"]').val();
            
            $.ajax({
              method : 'PUT',
              url : '/update',
              data : {_id: id, title : title, date: date},
              success : function(result){
                alert(result.msg);
                location.href = '/detail/'+id;
              },
            });
          });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>